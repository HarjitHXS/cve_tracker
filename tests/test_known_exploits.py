import unittest
from src.cve_tracker import NistCveSearcher


class TestExploitSearcher(unittest.TestCase):


    def test_exploit_valid_cve(self):
        exploit_catalog = ['CVE-2021-27104', 'CVE-2021-39144', 'CVE-2021-27101']
        cve_id = 'CVE-2021-39144'
        test_with_valid_exploit = NistCveSearcher._check_known_exploits(cve_id, exploit_catalog)
        self.assertTrue(test_with_valid_exploit)
        self.assertEqual(test_with_valid_exploit, 'Yes')


    def test_exploit_invalid_cve(self):
        exploit_catalog = ['CVE-2021-27104', 'CVE-2021-39144', 'CVE-2021-27101']
        cve_id = 'CVE-2022-31111'
        test_with_invalid_exploit = NistCveSearcher._check_known_exploits(cve_id, exploit_catalog)
        self.assertTrue(test_with_invalid_exploit)
        self.assertEqual(test_with_invalid_exploit, 'No')

